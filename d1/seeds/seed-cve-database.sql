-- seed-cve-database.sql
-- Top industrial/OT CVEs for edge devices (Siemens, Schneider, Fortinet, Palo Alto, Cisco, Rockwell, ABB, Honeywell)
-- Run via: npx wrangler d1 execute haiphen_api --local --file=d1/seeds/seed-cve-database.sql

-- Fortinet CVEs
INSERT OR REPLACE INTO secure_cve_database (cve_id, vendor, product, affected_versions, cvss_score, cvss_vector, severity, description, remediation, published_at) VALUES
('CVE-2024-21762', 'Fortinet', 'FortiOS', '["7.4.0-7.4.2","7.2.0-7.2.6","7.0.0-7.0.13","6.4.0-6.4.14","6.2.0-6.2.15"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Out-of-bounds write in FortiOS SSL VPN may allow remote unauthenticated attacker to execute arbitrary code via specially crafted HTTP requests.', 'Update FortiOS to 7.4.3, 7.2.7, 7.0.14, 6.4.15, or 6.2.16 or later.', '2024-02-09'),
('CVE-2024-23113', 'Fortinet', 'FortiOS', '["7.4.0-7.4.2","7.2.0-7.2.6","7.0.0-7.0.13"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Format string vulnerability in FortiOS fgfmd daemon allows remote unauthenticated attacker to execute arbitrary code.', 'Update FortiOS to 7.4.3 or later. Restrict access to fgfmd.', '2024-02-09'),
('CVE-2023-27997', 'Fortinet', 'FortiOS', '["7.2.0-7.2.4","7.0.0-7.0.11","6.4.0-6.4.12","6.2.0-6.2.14"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Heap buffer overflow in FortiOS SSL-VPN pre-authentication allows remote attacker to execute arbitrary code.', 'Update FortiOS to 7.2.5, 7.0.12, 6.4.13, or 6.2.15.', '2023-06-12'),
('CVE-2022-42475', 'Fortinet', 'FortiOS', '["7.2.0-7.2.2","7.0.0-7.0.8","6.4.0-6.4.10","6.2.0-6.2.12"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Heap-based buffer overflow in FortiOS SSL-VPN allows remote unauthenticated attacker to execute arbitrary code.', 'Update FortiOS to 7.2.3, 7.0.9, 6.4.11, or later.', '2023-01-02'),

-- Palo Alto Networks CVEs
('CVE-2024-3400', 'Palo Alto Networks', 'PAN-OS', '["10.2.0-10.2.9","11.0.0-11.0.4","11.1.0-11.1.2"]', 10.0, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H', 'critical', 'Command injection vulnerability in PAN-OS GlobalProtect Gateway allows unauthenticated attacker to execute arbitrary code with root privileges.', 'Apply PAN-OS hotfix. Disable GlobalProtect or apply threat prevention signature.', '2024-04-12'),
('CVE-2024-0012', 'Palo Alto Networks', 'PAN-OS', '["10.2.0-10.2.12","11.0.0-11.0.6","11.1.0-11.1.5","11.2.0-11.2.4"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Authentication bypass in PAN-OS management web interface allows unauthenticated attacker with network access to gain administrator privileges.', 'Restrict management interface access. Apply PAN-OS patches.', '2024-11-18'),
('CVE-2024-9474', 'Palo Alto Networks', 'PAN-OS', '["10.1.0-10.1.14","10.2.0-10.2.12","11.0.0-11.0.6","11.1.0-11.1.5"]', 7.2, 'CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H', 'high', 'OS command injection in PAN-OS allows authenticated administrator to escalate privileges and execute commands as root.', 'Apply PAN-OS security patches.', '2024-11-18'),

-- Siemens CVEs (Industrial PLCs and SCADA)
('CVE-2024-38876', 'Siemens', 'SINEMA Remote Connect Server', '["3.0.0-3.2.0"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Improper access control in SINEMA Remote Connect Server allows remote attackers to bypass authentication and gain administrative access.', 'Update SINEMA Remote Connect Server to V3.2 SP1 or later.', '2024-07-09'),
('CVE-2023-44373', 'Siemens', 'SCALANCE', '["multiple"]', 9.1, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N', 'critical', 'Command injection in SCALANCE networking devices allows remote attacker to execute arbitrary commands on the underlying operating system.', 'Apply Siemens security patches. Restrict network access.', '2023-11-14'),
('CVE-2023-46850', 'Siemens', 'S7-1500', '["V2.0-V3.0.3"]', 8.1, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:H', 'high', 'Improper validation in Siemens S7-1500 CPU allows remote attacker to read sensitive memory contents or cause denial of service.', 'Update S7-1500 firmware to V3.0.4 or later.', '2023-12-12'),
('CVE-2022-38465', 'Siemens', 'S7-1200', '["V4.0-V4.6.0"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Global private key extraction vulnerability in S7-1200/S7-1500 PLCs allows attacker to extract the global encryption key and impersonate any PLC.', 'Update firmware. Implement defense-in-depth measures.', '2022-10-11'),
('CVE-2022-46144', 'Siemens', 'SCALANCE', '["SC-600 V2.0-V3.0"]', 7.5, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H', 'high', 'Denial of service vulnerability in SCALANCE SC-600 industrial routers via specially crafted packets.', 'Update SCALANCE SC-600 firmware to V3.0.2 or later.', '2023-01-10'),
('CVE-2021-31886', 'Siemens', 'SINUMERIK', '["828D V4.7-V4.95","840D V4.7-V4.95"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Heap buffer overflow in SINUMERIK CNC controllers allows remote code execution via crafted requests to the integrated web server.', 'Update SINUMERIK firmware. Restrict web server access.', '2021-11-09'),

-- Schneider Electric CVEs
('CVE-2024-8306', 'Schneider Electric', 'EcoStruxure', '["Control Expert V15.0-V16.1","Unity Pro V15.0"]', 8.8, 'CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H', 'high', 'Improper privilege management in EcoStruxure Control Expert allows authenticated user to escalate privileges.', 'Update EcoStruxure Control Expert to V16.2 or later.', '2024-09-10'),
('CVE-2023-6409', 'Schneider Electric', 'Modicon', '["M340 V3.60-V3.65","M580 V4.10-V4.20"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Authentication bypass in Modicon PLCs allows remote unauthenticated attacker to write arbitrary values to PLC memory.', 'Update Modicon firmware. Implement network segmentation.', '2024-01-09'),
('CVE-2023-25620', 'Schneider Electric', 'Modicon', '["M340 V3.50-V3.60"]', 7.5, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H', 'high', 'Denial of service in Modicon M340 PLC via specially crafted Modbus requests causing CPU to enter stop state.', 'Update firmware to V3.60 SP1 or later.', '2023-04-18'),
('CVE-2022-34761', 'Schneider Electric', 'PowerLogic', '["ION7400 V3.0.0-V4.0.0"]', 7.5, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H', 'high', 'Buffer overflow in PowerLogic ION7400 power meter allows denial of service via crafted HTTP requests.', 'Update ION7400 firmware. Restrict network access.', '2022-07-13'),

-- Rockwell Automation CVEs
('CVE-2024-6242', 'Rockwell Automation', 'ControlLogix', '["1756-EN2T V11.003-V12.001"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'CIP protocol bypass in ControlLogix communication modules allows attacker to bypass the Trusted Slot feature and execute CIP commands.', 'Update firmware to V12.002 or later.', '2024-08-01'),
('CVE-2023-3595', 'Rockwell Automation', 'ControlLogix', '["1756-EN2T V11.003 and prior"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Out-of-bounds write in ControlLogix EtherNet/IP module allows remote code execution by unauthenticated attacker.', 'Update firmware. Apply Rockwell security patches.', '2023-07-12'),
('CVE-2023-3596', 'Rockwell Automation', 'CompactLogix', '["1769-L16ER V33.011 and prior"]', 7.5, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H', 'high', 'Denial of service in CompactLogix 5370 controllers via malformed CIP packets causing controller fault.', 'Update CompactLogix firmware.', '2023-07-12'),

-- Cisco Industrial CVEs
('CVE-2024-20356', 'Cisco', 'IOS XE', '["17.3.1-17.12.1"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Remote code execution in Cisco IOS XE web management interface allows unauthenticated attacker to create privileged account.', 'Apply Cisco security patches. Disable HTTP/HTTPS server feature.', '2024-04-17'),
('CVE-2023-20198', 'Cisco', 'IOS XE', '["16.12.1-17.9.4"]', 10.0, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H', 'critical', 'Privilege escalation in Cisco IOS XE web UI allows remote unauthenticated attacker to create high-privilege account.', 'Disable HTTP/HTTPS server feature. Apply Cisco patches.', '2023-10-16'),
('CVE-2023-20109', 'Cisco', 'Industrial Ethernet Switches', '["IE3200-IE3400 V17.0-V17.9"]', 6.6, 'CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H', 'medium', 'Vulnerability in Cisco Group Encrypted Transport VPN allows authenticated attacker to execute arbitrary code on industrial switches.', 'Apply Cisco security advisory updates.', '2023-09-27'),

-- ABB CVEs
('CVE-2023-6516', 'ABB', 'Ability Symphony Plus', '["S+ Operations V3.0-V3.3"]', 8.6, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:H', 'high', 'XML External Entity injection in ABB Symphony Plus DCS allows remote attacker to read arbitrary files or cause denial of service.', 'Update Symphony Plus to V3.3 SP2 or later.', '2024-02-14'),
('CVE-2023-0580', 'ABB', 'ASPECT', '["ASPECT-Enterprise V3.07.01 and prior"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Server-side request forgery in ABB ASPECT building management system allows unauthenticated attacker to access internal resources.', 'Update ASPECT-Enterprise firmware.', '2023-06-05'),

-- Honeywell CVEs
('CVE-2023-5389', 'Honeywell', 'Experion PKS', '["R520.1-R520.2"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Remote code execution in Honeywell Experion PKS DCS controller allows unauthenticated attacker to execute commands with system privileges.', 'Update Experion PKS to R520.2 HF3 or later.', '2024-01-30'),
('CVE-2023-5390', 'Honeywell', 'Experion PKS', '["R520.1-R520.2"]', 7.5, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N', 'high', 'Information disclosure in Honeywell Experion PKS allows unauthenticated attacker to read sensitive configuration data.', 'Update Experion PKS to R520.2 HF3 or later.', '2024-01-30'),

-- Additional industrial protocol CVEs
('CVE-2023-28489', 'Siemens', 'CP-8050', '["V5.20-V5.30"]', 9.8, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H', 'critical', 'Remote code execution in Siemens CP-8050 master module for SICAM A8000 allows unauthenticated network access.', 'Update CP-8050 firmware to V5.30 SP1.', '2023-04-11'),
('CVE-2022-2188', 'Schneider Electric', 'EcoStruxure', '["Machine Expert HVAC V1.0-V2.0"]', 7.8, 'CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H', 'high', 'Improper restriction of XML external entity reference in EcoStruxure Machine Expert HVAC allows code execution.', 'Update to Machine Expert HVAC V2.1 or later.', '2022-07-13'),
('CVE-2024-47901', 'Siemens', 'InterMesh', '["7521 V1.0-V2.0","7561 V1.0-V2.0"]', 10.0, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H', 'critical', 'Remote code execution vulnerability in Siemens InterMesh subscriber devices allows command injection via network requests.', 'Update InterMesh firmware to V2.1 or later.', '2024-11-12'),
('CVE-2024-38278', 'Siemens', 'RUGGEDCOM', '["ROS V5.0-V5.9"]', 6.7, 'CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H', 'medium', 'Privilege escalation in RUGGEDCOM ROS allows authenticated admin to gain root access on the underlying operating system.', 'Update RUGGEDCOM ROS to V5.9.1 or later.', '2024-07-09'),

-- BACnet/Modbus specific CVEs
('CVE-2023-4807', 'Tridium', 'Niagara Framework', '["4.10-4.13"]', 7.5, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H', 'high', 'Denial of service in Tridium Niagara Framework BACnet integration via malformed BACnet packets.', 'Update Niagara Framework to 4.13.1 or later.', '2023-09-08'),
('CVE-2022-0847', 'Linux', 'Kernel', '["5.8-5.16.10"]', 7.8, 'CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H', 'high', 'Dirty Pipe local privilege escalation affects embedded Linux-based industrial controllers and edge devices.', 'Update Linux kernel to 5.16.11, 5.15.25, or 5.10.102.', '2022-03-07'),
('CVE-2023-3935', 'WIBU-SYSTEMS', 'CodeMeter', '["7.50-7.60a"]', 9.0, 'CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H', 'critical', 'Heap buffer overflow in WIBU-SYSTEMS CodeMeter Runtime used by many industrial software packages for license management.', 'Update CodeMeter Runtime to 7.60b or later.', '2023-09-13'),

-- OPC-UA CVEs
('CVE-2023-27321', 'OPC Foundation', 'OPC UA', '["SDK 1.03-1.05.367"]', 7.5, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H', 'high', 'Null pointer dereference in OPC UA .NET SDK allows remote attacker to crash OPC UA server applications.', 'Update OPC UA .NET SDK to 1.05.368 or later.', '2023-05-03'),
('CVE-2022-29862', 'OPC Foundation', 'OPC UA', '["SDK 1.03-1.04.368"]', 7.5, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H', 'high', 'Infinite loop in OPC UA .NET SDK allows denial of service via crafted certificate chain.', 'Update OPC UA SDK. Limit certificate chain length.', '2022-06-16'),

-- MQTT/IoT CVEs
('CVE-2023-3028', 'Eclipse', 'Mosquitto', '["2.0.0-2.0.15"]', 8.2, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:H/A:N', 'high', 'Authentication bypass in Eclipse Mosquitto MQTT broker allows clients to bypass ACL restrictions.', 'Update Mosquitto to 2.0.16 or later.', '2023-06-01'),
('CVE-2023-0809', 'Eclipse', 'Mosquitto', '["1.3.2-2.0.14"]', 5.3, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N', 'medium', 'Information disclosure in Eclipse Mosquitto MQTT broker allows reading of messages beyond authorized subscriptions.', 'Update Mosquitto to 2.0.15 or later.', '2023-09-01'),

-- DNP3 CVEs
('CVE-2022-2097', 'Triangle MicroWorks', 'TMW DNP3', '["SDK V3.25-V3.29"]', 7.5, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H', 'high', 'Buffer overflow in Triangle MicroWorks DNP3 protocol stack allows denial of service via malformed DNP3 frames.', 'Update TMW DNP3 SDK to V3.30 or later.', '2022-07-01'),

-- Edge Gateway CVEs
('CVE-2024-21893', 'Ivanti', 'Connect Secure', '["9.1R14-22.6R2"]', 8.2, 'CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:L/A:N', 'high', 'Server-side request forgery in Ivanti Connect Secure VPN gateway used for edge network access allows unauthenticated access to restricted resources.', 'Apply Ivanti security patches. Monitor for IOCs.', '2024-01-31'),
('CVE-2024-21887', 'Ivanti', 'Connect Secure', '["9.1R14-22.6R2"]', 9.1, 'CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H', 'critical', 'Command injection in Ivanti Connect Secure web components allows authenticated administrator to execute arbitrary commands.', 'Apply Ivanti security patches immediately.', '2024-01-10');
