<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 540">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#0b1220"/>
      <stop offset="100%" stop-color="#0f1b2e"/>
    </linearGradient>
    <pattern id="dots" width="20" height="20" patternUnits="userSpaceOnUse">
      <circle cx="10" cy="10" r="0.8" fill="rgba(226,232,240,0.06)"/>
    </pattern>
    <linearGradient id="problemGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="rgba(245,158,11,0.12)"/>
      <stop offset="100%" stop-color="rgba(239,68,68,0.08)"/>
    </linearGradient>
    <linearGradient id="toolGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="rgba(90,155,212,0.15)"/>
      <stop offset="100%" stop-color="rgba(90,155,212,0.06)"/>
    </linearGradient>
    <linearGradient id="resolveGrad" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="rgba(16,185,129,0.12)"/>
      <stop offset="100%" stop-color="rgba(16,185,129,0.06)"/>
    </linearGradient>
    <filter id="glow">
      <feGaussianBlur stdDeviation="3" result="blur"/>
      <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
  </defs>

  <rect width="960" height="540" fill="url(#bg)"/>
  <rect width="960" height="540" fill="url(#dots)"/>

  <text x="480" y="42" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="16" font-weight="800" fill="#e2e8f0">Scenario: Modbus Traffic Anomaly Detection</text>

  <!-- Column 1: Problem -->
  <rect x="40" y="70" width="260" height="420" rx="14" fill="url(#problemGrad)" stroke="rgba(245,158,11,0.25)" stroke-width="1"/>
  <text x="170" y="100" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="13" font-weight="800" fill="#F59E0B">PROBLEM</text>

  <!-- Network anomaly icon -->
  <g transform="translate(170,170)" filter="url(#glow)">
    <circle cx="0" cy="0" r="28" fill="none" stroke="rgba(245,158,11,0.4)" stroke-width="1.5"/>
    <circle cx="0" cy="0" r="18" fill="none" stroke="rgba(245,158,11,0.3)" stroke-width="1"/>
    <!-- Signal waves -->
    <path d="M-20,-8 Q-10,-20 0,-8 Q10,4 20,-8" fill="none" stroke="#F59E0B" stroke-width="2" opacity="0.8"/>
    <path d="M-20,8 Q-10,20 0,8 Q10,-4 20,8" fill="none" stroke="#EF4444" stroke-width="2" opacity="0.8"/>
    <!-- Alert dot -->
    <circle cx="18" cy="-18" r="5" fill="#EF4444" opacity="0.9"/>
    <text x="18" y="-14.5" text-anchor="middle" font-family="ui-monospace,monospace" font-size="8" fill="#fff" font-weight="800">!</text>
  </g>

  <text x="170" y="230" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="11" fill="#e2e8f0" opacity="0.9">Unknown Modbus traffic</text>
  <text x="170" y="250" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="11" fill="#e2e8f0" opacity="0.7">anomaly on PLC floor</text>

  <rect x="65" y="280" width="210" height="28" rx="6" fill="rgba(239,68,68,0.12)" stroke="rgba(239,68,68,0.3)" stroke-width="1"/>
  <text x="170" y="299" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="#EF4444">Unexpected write commands</text>

  <rect x="65" y="318" width="210" height="28" rx="6" fill="rgba(245,158,11,0.12)" stroke="rgba(245,158,11,0.3)" stroke-width="1"/>
  <text x="170" y="337" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="#F59E0B">Source IP unrecognized</text>

  <rect x="65" y="356" width="210" height="28" rx="6" fill="rgba(245,158,11,0.1)" stroke="rgba(245,158,11,0.2)" stroke-width="1"/>
  <text x="170" y="375" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="#F59E0B">Packet rate 3x baseline</text>

  <text x="170" y="430" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="rgba(226,232,240,0.5)">No protocol-level visibility</text>

  <!-- Arrow 1 -->
  <line x1="310" y1="280" x2="340" y2="280" stroke="rgba(226,232,240,0.3)" stroke-width="1.5" stroke-dasharray="4,3">
    <animate attributeName="stroke-dashoffset" from="14" to="0" dur="1.5s" repeatCount="indefinite"/>
  </line>
  <polygon points="340,276 350,280 340,284" fill="rgba(226,232,240,0.4)"/>

  <!-- Column 2: Tool -->
  <rect x="350" y="70" width="260" height="420" rx="14" fill="url(#toolGrad)" stroke="rgba(90,155,212,0.25)" stroke-width="1"/>
  <text x="480" y="100" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="13" font-weight="800" fill="#5A9BD4">HAIPHEN TOOL</text>

  <!-- Terminal -->
  <rect x="375" y="130" width="210" height="130" rx="8" fill="rgba(0,0,0,0.4)" stroke="rgba(90,155,212,0.3)" stroke-width="1"/>
  <circle cx="390" cy="144" r="4" fill="#EF4444" opacity="0.7"/>
  <circle cx="402" cy="144" r="4" fill="#F59E0B" opacity="0.7"/>
  <circle cx="414" cy="144" r="4" fill="#10B981" opacity="0.7"/>

  <text x="385" y="172" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="#5A9BD4">$</text>
  <text x="396" y="172" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="#e2e8f0">haiphen network trace \</text>
  <text x="396" y="188" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="#e2e8f0">  --target plc-floor1:502 \</text>
  <text x="396" y="204" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="#e2e8f0">  --protocol modbus</text>

  <text x="385" y="230" font-family="ui-monospace,SFMono-Regular,monospace" font-size="9" fill="#10B981">Capturing 1,247 packets...</text>
  <text x="385" y="246" font-family="ui-monospace,SFMono-Regular,monospace" font-size="9" fill="#10B981">Anomaly detected: FC=16</text>

  <text x="480" y="290" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="12" font-weight="800" fill="#5A9BD4">haiphen network trace</text>
  <text x="480" y="310" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="rgba(226,232,240,0.7)">Packet-level inspection</text>
  <text x="480" y="326" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="rgba(226,232,240,0.7)">Modbus function code decode</text>
  <text x="480" y="342" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="rgba(226,232,240,0.7)">Anomaly baseline comparison</text>

  <rect x="400" y="370" width="160" height="6" rx="3" fill="rgba(0,0,0,0.3)"/>
  <rect x="400" y="370" width="160" height="6" rx="3" fill="rgba(90,155,212,0.6)">
    <animate attributeName="width" from="0" to="160" dur="2s" fill="freeze"/>
  </rect>
  <text x="480" y="395" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="9" fill="rgba(226,232,240,0.5)">Trace captured in 8s</text>

  <!-- Arrow 2 -->
  <line x1="620" y1="280" x2="650" y2="280" stroke="rgba(226,232,240,0.3)" stroke-width="1.5" stroke-dasharray="4,3">
    <animate attributeName="stroke-dashoffset" from="14" to="0" dur="1.5s" repeatCount="indefinite"/>
  </line>
  <polygon points="650,276 660,280 650,284" fill="rgba(226,232,240,0.4)"/>

  <!-- Column 3: Resolution -->
  <rect x="660" y="70" width="260" height="420" rx="14" fill="url(#resolveGrad)" stroke="rgba(16,185,129,0.25)" stroke-width="1"/>
  <text x="790" y="100" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="13" font-weight="800" fill="#10B981">RESOLUTION</text>

  <!-- Decoded packet icon -->
  <g transform="translate(790,170)" filter="url(#glow)">
    <circle cx="0" cy="0" r="28" fill="none" stroke="rgba(16,185,129,0.4)" stroke-width="1.5"/>
    <path d="M-20,-8 Q-10,-20 0,-8 Q10,4 20,-8" fill="none" stroke="#10B981" stroke-width="2" opacity="0.8"/>
    <path d="M-20,8 Q-10,-4 0,8 Q10,20 20,8" fill="none" stroke="#10B981" stroke-width="2" opacity="0.8"/>
    <circle cx="18" cy="-18" r="5" fill="#10B981" opacity="0.9"/>
    <polyline points="15,-18 17.5,-15.5 21,-20" fill="none" stroke="#fff" stroke-width="1.5" stroke-linecap="round"/>
  </g>

  <text x="790" y="230" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="11" fill="#e2e8f0" opacity="0.9">Protocol decoded</text>
  <text x="790" y="250" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="11" fill="#e2e8f0" opacity="0.7">Anomaly isolated</text>

  <rect x="685" y="275" width="210" height="28" rx="6" fill="rgba(16,185,129,0.1)" stroke="rgba(16,185,129,0.3)" stroke-width="1"/>
  <text x="790" y="294" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="#10B981">FC=16 write from rogue IP</text>

  <rect x="685" y="313" width="210" height="28" rx="6" fill="rgba(16,185,129,0.08)" stroke="rgba(16,185,129,0.2)" stroke-width="1"/>
  <text x="790" y="332" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="#10B981">Block 10.0.3.47 at firewall</text>

  <rect x="685" y="351" width="210" height="28" rx="6" fill="rgba(16,185,129,0.06)" stroke="rgba(16,185,129,0.15)" stroke-width="1"/>
  <text x="790" y="370" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="#10B981">Baseline updated: +FC=16</text>

  <rect x="685" y="389" width="210" height="28" rx="6" fill="rgba(16,185,129,0.04)" stroke="rgba(16,185,129,0.12)" stroke-width="1"/>
  <text x="790" y="408" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="#10B981">Continuous monitoring on</text>

  <text x="790" y="450" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="rgba(226,232,240,0.5)">Threat contained, baseline hardened</text>

  <text x="480" y="524" text-anchor="middle" font-family="ui-monospace,SFMono-Regular,monospace" font-size="10" fill="rgba(226,232,240,0.3)">haiphen.io</text>
</svg>
