<!-- docs/components/profile/profile.html -->
<section class="hp-profile" aria-label="Profile">
  <div class="hp-profile__top">
    <div class="hp-profile__titlewrap">
      <h2 class="hp-profile__title">Profile</h2>
      <p class="hp-profile__sub">
        Manage your Haiphen account settings and API keys.
      </p>
    </div>
    <div class="hp-profile__actions">
      <a
        class="hp-profile__btn hp-profile__btn--ghost"
        href="https://auth.haiphen.io/logout?to=https%3A%2F%2Fhaiphen.io%2F"
        data-profile-action="logout"
      >
        Logout
      </a>
    </div>
  </div>

  <div class="hp-profile__grid">
    <!-- Onboarding destination -->
    <div id="profile-onboarding" class="hp-card hp-card--full hp-onboarding">
      <div class="hp-card__hd">
        <div>
          <div class="hp-card__title">Onboarding Hub</div>
          <div class="hp-card__sub">Start here after payment. These links cover setup, access, and operating steps.</div>
        </div>
      </div>
      <div class="hp-card__bd">
        <div class="hp-onboarding__intro">
          <p class="hp-onboarding__lead">
            Access is now centralized under your account. Begin with API key setup, then use docs/CLI for integration.
          </p>
          <a class="hp-profile__btn hp-profile__btn--primary" href="#profile">Open API key controls</a>
        </div>

        <div class="hp-onboarding__video">
          <iframe
            title="Haiphen onboarding briefing"
            src="https://drive.google.com/file/d/1pjF73rMSsbIJbgS0dOyFL0eX1vbCJm2Z/preview"
            loading="lazy"
            allow="autoplay"
          ></iframe>
        </div>

        <div class="hp-onboarding__grid">
          <a class="hp-onboarding__item" href="https://app.haiphen.io/" target="_blank" rel="noopener" data-onboarding-link="app_url">
            <strong>Web App</strong>
            <span>Open account workspace and primary UI.</span>
          </a>
          <a class="hp-onboarding__item" href="#docs" data-onboarding-link="docs_url">
            <strong>API Docs</strong>
            <span>Reference endpoints, payloads, and examples.</span>
          </a>
          <a class="hp-onboarding__item" href="#profile" data-onboarding-link="profile_url">
            <strong>Profile + Keys</strong>
            <span>Rotate/revoke keys and update email preferences.</span>
          </a>
          <a class="hp-onboarding__item" href="#cohort" data-onboarding-link="cohort_url">
            <strong>Cohort Guide</strong>
            <span>Program details, timeline, and FAQ.</span>
          </a>
          <a class="hp-onboarding__item" href="https://calendar.app.google/jQzWz98eCC5jMLrQA" target="_blank" rel="noopener" data-onboarding-link="calendar_url">
            <strong>Book Onboarding Call</strong>
            <span>Schedule integration walkthrough/support.</span>
          </a>
          <a class="hp-onboarding__item" href="mailto:pi@haiphenai.com" data-onboarding-link="support_email">
            <strong>Support Channel</strong>
            <span>Contact support for blockers and production issues.</span>
          </a>
        </div>

        <div class="hp-onboarding__services-head">
          <div class="hp-card__title">Service Quick Start</div>
          <div class="hp-card__sub">Access each Haiphen service via docs or CLI.</div>
        </div>

        <div class="hp-onboarding__grid hp-onboarding__grid--services">
          <a class="hp-onboarding__item hp-onboarding__item--service" href="#docs:docs-cli-commands" data-onboarding-link="cli_docs_url">
            <strong>Haiphen CLI</strong>
            <span>Local gateway and command center.</span>
            <code class="hp-onboarding__cmd">haiphen serve</code>
          </a>
          <a class="hp-onboarding__item hp-onboarding__item--service" href="#docs:docs-endpoints" data-onboarding-link="metrics_docs_url">
            <strong>Trading Metrics</strong>
            <span>KPIs, time-series, and portfolio assets.</span>
            <code class="hp-onboarding__cmd">haiphen metrics kpis</code>
          </a>
          <a class="hp-onboarding__item hp-onboarding__item--service" href="#docs:docs-secure" data-onboarding-link="secure_docs_url">
            <strong>Haiphen Secure</strong>
            <span>Vulnerability and compliance scanning.</span>
            <code class="hp-onboarding__cmd">haiphen secure scan --target &lt;t&gt;</code>
          </a>
          <a class="hp-onboarding__item hp-onboarding__item--service" href="#docs:docs-network" data-onboarding-link="network_docs_url">
            <strong>Network Trace</strong>
            <span>Protocol-level traffic analysis.</span>
            <code class="hp-onboarding__cmd">haiphen network trace --target &lt;t&gt;</code>
          </a>
          <a class="hp-onboarding__item hp-onboarding__item--service" href="#docs:docs-graph" data-onboarding-link="graph_docs_url">
            <strong>Knowledge Graph</strong>
            <span>Entity relationships and topology queries.</span>
            <code class="hp-onboarding__cmd">haiphen graph query --q &lt;query&gt;</code>
          </a>
          <a class="hp-onboarding__item hp-onboarding__item--service" href="#docs:docs-risk" data-onboarding-link="risk_docs_url">
            <strong>Risk Analysis</strong>
            <span>Scenario modeling and risk assessments.</span>
            <code class="hp-onboarding__cmd">haiphen risk assess --scenario &lt;s&gt;</code>
          </a>
          <a class="hp-onboarding__item hp-onboarding__item--service" href="#docs:docs-causal" data-onboarding-link="causal_docs_url">
            <strong>Causal Chain</strong>
            <span>Root-cause and event chain analysis.</span>
            <code class="hp-onboarding__cmd">haiphen causal analyze --events &lt;file&gt;</code>
          </a>
          <a class="hp-onboarding__item hp-onboarding__item--service" href="#docs:docs-supply" data-onboarding-link="supply_docs_url">
            <strong>Supply Chain Intel</strong>
            <span>Supplier risk scoring and alerts.</span>
            <code class="hp-onboarding__cmd">haiphen supply assess --supplier &lt;name&gt;</code>
          </a>
        </div>
      </div>
    </div>

    <!-- Account -->
    <div class="hp-card">
      <div class="hp-card__hd">
        <div>
          <div class="hp-card__title">Account</div>
          <div class="hp-card__sub">Signed-in identity and plan status.</div>
        </div>
      </div>

      <div class="hp-card__bd">
        <div class="hp-kv">
          <div class="hp-kv__row">
            <div class="hp-kv__k">User</div>
            <div class="hp-kv__v" data-profile-user>—</div>
          </div>
          <div class="hp-kv__row">
            <div class="hp-kv__k">Email</div>
            <div class="hp-kv__v" data-profile-email>—</div>
          </div>
          <div class="hp-kv__row">
            <div class="hp-kv__k">Plan</div>
            <div class="hp-kv__v"><span class="hp-pill" data-profile-plan>—</span></div>
          </div>
        </div>

        <div class="hp-note">
          Cookie auth is used for the dashboard. API keys (Bearer tokens) are used for metrics/RSS/webhooks.
        </div>
      </div>
    </div>

    <!-- API Keys -->
    <div class="hp-card">
      <div class="hp-card__hd hp-card__hd--split">
        <div>
          <div class="hp-card__title">API Keys</div>
          <div class="hp-card__sub">Rotate, copy, and revoke keys. Your raw token is shown only once.</div>
        </div>

        <div class="hp-card__hdActions">
          <button class="hp-profile__btn hp-profile__btn--primary" type="button" data-profile-action="rotate">
            Rotate key
          </button>
        </div>
      </div>

      <div class="hp-card__bd">
        <!-- Inline status / toast -->
        <div class="hp-status" data-profile-status hidden></div>

        <!-- New key reveal (sticky until dismissed) -->
        <div class="hp-reveal" data-profile-reveal hidden>
          <div class="hp-reveal__hd">
            <div>
              <div class="hp-reveal__title">New API key</div>
              <div class="hp-reveal__sub">Copy this now. You won’t be able to view it again.</div>
            </div>

            <div class="hp-reveal__hdActions">
              <button class="hp-profile__btn hp-profile__btn--ghost" type="button" data-profile-action="toggle-visibility">
                Hide
              </button>
              <button class="hp-profile__btn hp-profile__btn--ghost" type="button" data-profile-action="dismiss-reveal">
                Dismiss
              </button>
            </div>
          </div>

          <div class="hp-reveal__codeRow">
            <code class="hp-code hp-code--reveal" data-profile-newkey>—</code>
            <button class="hp-profile__btn hp-profile__btn--ghost" type="button" data-profile-action="copy-new">
              Copy
            </button>
          </div>

          <div class="hp-reveal__foot">
            Store this in a password manager or secrets vault (1Password, Bitwarden, Doppler, etc).
          </div>
        </div>

        <!-- Active key summary -->
        <div class="hp-activeKey" data-profile-activekey>
          <div class="hp-activeKey__top">
            <div class="hp-activeKey__title">Active key</div>
            <div class="hp-activeKey__actions">
              <button class="hp-profile__btn hp-profile__btn--ghost" type="button" data-profile-action="copy-prefix">
                Copy prefix
              </button>
              <button class="hp-profile__btn hp-profile__btn--ghost" type="button" data-profile-action="revoke-active">
                Revoke
              </button>
            </div>
          </div>

          <div class="hp-activeKey__meta">
            <div><span class="hp-muted">Prefix:</span> <code class="hp-code" data-profile-active-prefix>—</code></div>
            <div><span class="hp-muted">Scopes:</span> <span data-profile-active-scopes>—</span></div>
            <div><span class="hp-muted">Created:</span> <span data-profile-active-created>—</span></div>
            <div><span class="hp-muted">Last used:</span> <span data-profile-active-used>—</span></div>
          </div>

          <!-- hidden: active key id (so revoke-active can work without re-listing) -->
          <div data-profile-active-id hidden>—</div>
        </div>

        <div class="hp-divider"></div>

        <!-- Keys table -->
        <div class="hp-tableWrap">
          <table class="hp-table" aria-label="API keys">
            <thead>
              <tr>
                <th>Status</th>
                <th>Prefix</th>
                <th>Scopes</th>
                <th>Created</th>
                <th>Last used</th>
                <th>Revoked</th>
                <th></th>
              </tr>
            </thead>
            <tbody data-profile-keys-tbody>
              <tr><td colspan="7" class="hp-muted">Loading…</td></tr>
            </tbody>
          </table>
        </div>

        <div class="hp-note hp-note--danger">
          Never paste API keys into public Slack channels or GitHub issues. Revoke immediately if exposed.
        </div>
      </div>
    </div>

    <!-- Email Preferences -->
    <div class="hp-card hp-card--full">
      <div class="hp-card__hd">
        <div>
          <div class="hp-card__title">Email Preferences</div>
          <div class="hp-card__sub">Control which program emails you receive.</div>
        </div>
      </div>

      <div class="hp-card__bd">
        <div class="hp-status" data-profile-pref-status hidden></div>

        <form class="hp-pref" data-profile-pref-form>
          <label class="hp-pref__item">
            <input type="checkbox" name="daily_digest" />
            <span>Daily Market Digest</span>
          </label>

          <label class="hp-pref__item">
            <input type="checkbox" name="weekly_summary" />
            <span>Weekly Performance Summary</span>
          </label>

          <label class="hp-pref__item">
            <input type="checkbox" name="product_updates" />
            <span>Product Updates & Announcements</span>
          </label>

          <label class="hp-pref__item">
            <input type="checkbox" name="cohort_comms" />
            <span>Cohort Program Communications</span>
          </label>

          <div class="hp-pref__actions">
            <button class="hp-profile__btn hp-profile__btn--primary" type="submit" data-profile-pref-save>
              Save preferences
            </button>
            <span class="hp-pref__note">Applies to future sends.</span>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>
